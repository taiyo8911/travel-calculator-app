# トラベルメモリーズ (Travel Memories)
海外旅行時の両替記録と買い物記録を管理し、レートや支出金額を日本円で把握できる旅行用現金特化管理アプリ

## 主な機能
### 旅行管理
* 複数の旅行を作成・管理
* 旅行ごとに通貨を設定（18種類の通貨に対応）
* 旅行期間の設定と日数の自動計算
* 旅行のステータス表示（現在旅行中/予定/終了）
* 旅行情報の編集機能（通貨以外）
* 旅行記録のPDF出力・共有機能

### 両替記録
* 両替した日本円と受け取った外貨の記録
* 両替所の表示レートと実質レートの計算
* 手数料率の自動計算と高手数料（3%以上）の警告表示
* 両替記録の一覧表示、追加、編集、削除
* 国旗絵文字による通貨の視覚的表示

### 買い物記録
* 外貨での支出記録
* 買い物内容の説明記録
* 加重平均レートを使った日本円換算額の計算
* 買い物記録の一覧表示、追加、編集、削除
* 両替記録がない場合の入力制限（安全対策）

### 集計機能
* 旅行全体の両替総額（円・外貨）
* 加重平均レートの自動計算
* 買い物総額（外貨・日本円換算）
* 残り外貨の計算と日本円換算
* 最高・最低両替レート分析
* 最高・最低支出額分析

## UI/UX
* モダンなカスタムヘッダーデザイン（グラデーション背景）
* タブベースではなく、NavigationStackベースのナビゲーション
* カード形式での直感的な操作
* サマリーカードによる重要情報の可視化
* ダークモード対応
* 視覚的フィードバック（警告表示、ステータスバッジ）
* コンテキストメニューによる編集・削除操作
* リアルタイム計算とプレビュー表示

## データ管理
* ローカルデータの永続化（UserDefaults）
* 設定画面でのデータリセット機能
* バージョン情報とアプリ情報の表示

## アプリ構成
アプリはMVVMアーキテクチャに基づいて設計され、SwiftUIを使用して構築されています。

### 使用技術
* SwiftUI - モダンなUIフレームワーク
* Combine - データフローの管理
* PDFKit - PDF生成と共有
* UserDefaults - データの永続化
* NavigationStack - iOS 16スタイルナビゲーション

## モデルサンプルデータ

### Currency モデル
| id | code | name |
|-----|------|------|
| UUID-C1 | USD | 米ドル |
| UUID-C2 | EUR | ユーロ |
| UUID-C3 | GBP | 英ポンド |
| UUID-C4 | AUD | 豪ドル |
| UUID-C5 | THB | タイバーツ |

### Trip モデル
| id | name | currency | startDate | endDate | exchangeRecords | purchaseRecords |
|-----|------|---------|-----------|---------|-----------------|-----------------|
| UUID-1 | アメリカ旅行 | UUID-C1 (USD) | 2025-04-09 | 2025-04-20 | [UUID-E1, UUID-E2] | [UUID-P1, UUID-P2, UUID-P3] |
| UUID-2 | ヨーロッパ周遊 | UUID-C2 (EUR) | 2025-05-01 | 2025-05-15 | [UUID-E3, UUID-E4] | [UUID-P4, UUID-P5, UUID-P6] |
| UUID-3 | タイ旅行 | UUID-C5 (THB) | 2025-07-19 | 2025-07-25 | [UUID-E5] | [UUID-P7, UUID-P8] |
| UUID-4 | イギリス出張 | UUID-C3 (GBP) | 2025-09-04 | 2025-09-10 | [UUID-E6] | [UUID-P9, UUID-P10] |

### ExchangeRecord モデル
| id | date | jpyAmount | displayRate | foreignAmount | actualRate | feePercentage | isHighFee |
|-----|------------|-----------|-------------|---------------|------------|--------------|-----------|
| UUID-E1 | 2025-04-09 | 100000 | 147.0 | 666.67 | 150.0 | 2.04 | 否 |
| UUID-E2 | 2025-04-15 | 50000 | 145.0 | 334.45 | 149.5 | 3.10 | 是 |
| UUID-E3 | 2025-05-01 | 150000 | 160.0 | 909.09 | 165.0 | 3.13 | 是 |
| UUID-E4 | 2025-05-10 | 80000 | 162.0 | 485.44 | 164.8 | 1.73 | 否 |
| UUID-E5 | 2025-07-19 | 100000 | 4.0 | 23809.52 | 4.2 | 5.00 | 是 |
| UUID-E6 | 2025-09-04 | 120000 | 205.0 | 571.43 | 210.0 | 2.44 | 否 |

### PurchaseRecord モデル（旅行別）
#### アメリカ旅行 (USD) の買い物記録
| id | date | foreignAmount | description | jpyAmount (149.83円/USD) |
|-----|------------|--------------|-------------|-----------------------------|
| UUID-P1 | 2025-04-11 | 45.99 | ニューヨーク観光ツアー | 6,890.30円 |
| UUID-P2 | 2025-04-13 | 89.50 | お土産（Tシャツ、マグカップ） | 13,409.79円 |
| UUID-P3 | 2025-04-18 | 120.75 | ディナー at スカイレストラン | 18,091.97円 |

#### ヨーロッパ周遊 (EUR) の買い物記録
| id | date | foreignAmount | description | jpyAmount (165.05円/EUR) |
|-----|------------|--------------|-------------|-----------------------------|
| UUID-P4 | 2025-05-02 | 55.00 | パリ地下鉄チケット | 9,077.73円 |
| UUID-P5 | 2025-05-03 | 145.80 | 美術館入場料とお土産 | 24,064.29円 |
| UUID-P6 | 2025-05-12 | 210.50 | 高級レストランでのディナー | 34,743.03円 |

#### タイ旅行 (THB) の買い物記録
| id | date | foreignAmount | description | jpyAmount (4.2円/THB) |
|-----|------------|--------------|-------------|-----------------------------|
| UUID-P7 | 2025-07-21 | 1250.00 | タイ料理クッキングクラス | 5,250.00円 |
| UUID-P8 | 2025-07-23 | 3500.00 | エレファントサファリツアー | 14,700.00円 |

#### イギリス出張 (GBP) の買い物記録
| id | date | foreignAmount | description | jpyAmount (210.0円/GBP) |
|-----|------------|--------------|-------------|-----------------------------|
| UUID-P9 | 2025-09-06 | 42.50 | ロンドン観光バスツアー | 8,925.00円 |
| UUID-P10 | 2025-09-09 | 85.75 | ビジネスディナー | 18,007.50円 |

### 旅行別集計データ
| 旅行名 | 合計両替額(JPY) | 合計外貨取得額 | 加重平均レート | 合計支出(外貨) | 合計支出(JPY換算) |
|---------|-------------------|-------------------|-----------------|-------------------|----------------------|
| アメリカ旅行 | 150,000円 | 1,001.12 USD | 149.83円/USD | 256.24 USD | 38,392.06円 |
| ヨーロッパ周遊 | 230,000円 | 1,394.53 EUR | 165.05円/EUR | 411.30 EUR | 67,885.05円 |
| タイ旅行 | 100,000円 | 23,809.52 THB | 4.2円/THB | 4,750.00 THB | 19,950.00円 |
| イギリス出張 | 120,000円 | 571.43 GBP | 210.0円/GBP | 128.25 GBP | 26,932.50円 |


## 操作フロー
1. 旅行リスト画面から新規旅行を作成
2. 旅行詳細画面で両替情報を登録
3. 買い物履歴を記録
4. 旅行中の支出を管理・確認
5. 旅行終了後はPDF出力で記録を保存・共有

## 対応通貨一覧（18種類）
* 北米・南米: 米ドル(USD)、カナダドル(CAD)、メキシコペソ(MXN)
* ヨーロッパ: ユーロ(EUR)、英ポンド(GBP)、スイスフラン(CHF)
* 東アジア: 中国元(CNY)、香港ドル(HKD)、台湾ドル(TWD)、韓国ウォン(KRW)
* 東南アジア: タイバーツ(THB)、シンガポールドル(SGD)、マレーシアリンギット(MYR)、インドネシアルピア(IDR)、ベトナムドン(VND)、フィリピンペソ(PHP)
* オセアニア: 豪ドル(AUD)、NZドル(NZD)

## PDF出力機能
旅行記録をPDFで出力・共有できる機能を搭載。以下の情報が含まれます：
### 1ページ目：両替情報
* 旅行の基本情報（名称、期間、通貨）
* 両替サマリー（総額、取得外貨、回数、平均レート）
* 両替分析（最高・最低レート）
* 両替履歴詳細テーブル

### 2ページ目：支出情報
* 支出サマリー（外貨総額、円換算総額、回数）
* 支出分析（最高・最低支出、残り外貨）
* 買い物履歴詳細テーブル

## 主要機能の計算ロジック
### 加重平均レート計算
加重平均レート = 総両替円額 ÷ 総取得外貨額

### 手数料計算
実質レート = 両替円額 ÷ 取得外貨額
手数料率 = ((実質レート - 表示レート) ÷ 表示レート) × 100
高手数料判定 = 手数料率 > 3.0%

### 日本円換算
買い物の円換算額 = 外貨支出額 × 加重平均レート

## ファイル構成
```
TravelCalculator/
├── App/
│   └── TravelCalculatorApp.swift  // アプリのエントリーポイント
|   └── ContentView.swift          // メインコンテンツビュー
│
├── Models/
│   ├── Trip.swift                 // 旅行モデル
│   ├── Currency.swift             // 通貨モデル
│   ├── ExchangeRecord.swift       // 両替記録モデル
│   └── PurchaseRecord.swift       // 買い物記録モデル
│
├── ViewModels/
│   └── TravelCalculatorViewModel.swift  // メインビューモデル
│
├── Views/
│   ├── Trips/
│   │   ├── TripListView.swift     // 旅行一覧画面
│   │   ├── AddTripView.swift      // 旅行追加画面
│   │   └── TripDetailView.swift   // 旅行詳細画面
│   │
│   ├── Exchange/
│   │   ├── ExchangeListView.swift // 両替履歴画面
│   │   ├── AddExchangeView.swift  // 両替追加画面
│   │   └── EditExchangeView.swift // 両替編集画面
│   │
│   ├── Purchase/
│   │   ├── PurchaseListView.swift // 買い物履歴画面
│   │   ├── AddPurchaseView.swift  // 買い物追加画面
│   │   └── EditPurchaseView.swift // 買い物編集画面
│   │
│   ├── Components/
│   │   ├── SummaryCard.swift      // 集計カードコンポーネント
│   │   ├── ExchangeCard.swift     // 両替カードコンポーネント
│   │   └── PurchaseCard.swift     // 買い物カードコンポーネント
│   │
│   └── Settings/
│       └── SettingsView.swift     // 設定画面
│
└── Utilities/
    ├── CurrencyFormatter.swift    // 通貨フォーマッタ
    ├── FlagEmoji.swift            // 国旗絵文字ユーティリティ
    └── PDFGenerator.swift         // PDF生成ユーティリティ
```

## 技術仕様
### 開発環境
* 言語: Swift 5.5+
* フレームワーク: SwiftUI 3.0+
* アーキテクチャ: MVVM（Model-View-ViewModel）
* 最低動作環境: iOS 14.0以上
* 対応デバイス: iPhone / iPad

### 主要な実装特徴
* リアルタイム計算: 入力中にリアルタイムで手数料や換算額を表示
* データ整合性: 両替記録がない場合の適切な警告表示と入力制限
* 視覚的フィードバック: 国旗絵文字、色分け警告、ステータスバッジ
* 直感的操作: コンテキストメニュー、スワイプ削除、ワンタップ遷移
* 完全オフライン: インターネット接続不要で全機能利用可能
